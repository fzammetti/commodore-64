10 SYS9*4096
20 .CODE 0
25 *=$C000
30 SEI:LDA #<IRQ1:LDX #>IRQ1:STA $0314:STX $0315
40 LDA #$1B:STA $D011
50 LDA #$01:STA $D019:STA $D01A
60 LDA #$7F:STA $DC0D
70 LDA #$32:STA $D012
75 JSR RESCR
80 CLI:RTS
90 ;
100 IRQ1 LDA $01:STA $D019:LDY #$01
101 NOP
110 LDA CDAT:STA $D020:STA $D021
120 LDA STEMP:STA $D016:LDX #$01:JSR TMC
130 LOOP1 LDA CDAT,Y:STA $D020:STA $D021:LDX #$05:JSR TMC
140 INY:CPY #$10:BNE LOOP1
150 LDA #$00:STA $D020:STA $D021:LDA #$C8:STA $D016
160 JSR SCR:JMP $EA31
170 TMC DEX:BPL TMC:NOP:RTS
180 SCR DEC STEMP:LDA STEMP:CMP #$BF:BEQ SCR2:RTS
190 SCR2 LDA #$C7:STA STEMP:LDX #$00
200 LOOP2 LDA 1025,X:STA 1024,X:LDA 1065,X:STA 1064,X
205 INX:CPX #$28:BNE LOOP2
210 SCR3 LDY #$00:LDA ($B0),Y:CMP #$00:BEQ RESCR:STA 1024+39
212 CMP #$20:BEQ CONTIT
215 CLC:ADC #$80:STA 1064+39
220 CONTIT INC $B0:LDA $B0:CMP #$00:BNE ENSCR:INC $B1
230 ENSCR RTS
900 RESCR LDA #$00:LDX #$50:STA $B0:STX $B1:JMP SCR3
1001 STEMP .BYTE $C7
1002 CDAT .BYTE 0,0,0,0,0,0,0,0
1003 .BYTE 0,0,0,0,0,0,0,0,0