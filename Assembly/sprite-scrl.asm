10 SYS9*4096
12 .CODE 0
14 *=$C000
20 SETUP SEI:LDA #$7F:STA $DC0D:LDA #$01:STA $D019:STA $D01A
22 LDA #$1B:STA $D011:JSR SETSPR:LDA #<IRQ:LDX #>IRQ:STA $0314:STX $0315
23 LDA #$80:STA $D012:CLI
24 JSR RESET:RTS
26 SETSPR LDX #$00:LDA #$18:SSLOOP1 STA $D000,X:PHA:INX:LDA #$E4:STA $D000,X
28 PLA:CLC:ADC #$30:INX:CPX #$10:BNE SSLOOP1:LDX #$00:LDA #$20
30 SSLOOP2 STA $07F8,X:PHA:LDA #$01:STA $D027,X:PLA:CLC:ADC #$01
32 INX:CPX #$08:BNE SSLOOP2:LDA #$FF:STA $D015:STA $D017:STA $D01D:LDA #$E0
34 STA $D010:LDA #$00:LDX #$00:SSLOOP3 STA $0800,X:STA $0900,X:INX:BNE SSLOOP3
36 RTS
38 IRQ LDA #$01:STA $D019:JSR SPRSCR:JMP $EA31
40 SPRSCR JSR ROLSHIT:INC RTEMP:LDA RTEMP:CMP #24:BNE ENSPR
42 LDA #$00:STA RTEMP:JSR PUT3CHR:ENSPR RTS
44 RTEMP .BYTE $00
46 ROLSHIT LDX #$00:CLC
48 ROLLOOP ROL $09C2,X:ROL $09C1,X
50 ROL $09C0,X:ROL $0982,X:ROL $0981,X
52 ROL $0980,X:ROL $0942,X:ROL $0941,X
54 ROL $0940,X:ROL $0902,X:ROL $0901,X
56 ROL $0900,X:ROL $08C2,X:ROL $08C1,X
58 ROL $08C0,X:ROL $0882,X:ROL $0881,X
60 ROL $0880,X:ROL $0842,X
62 ROL $0841,X:ROL $0840,X
64 ROL $0802,X:ROL $0801,X
66 ROL $0800,X
68 INX:INX:INX:CPX #24:BNE ROLLOOP:RTS
70 PUT3CHR JSR FLIPZ:JSR GCHR:LDX #$00
72 PUT3CHR2 LDA #$00:STA $B1:LDA CHTEMP,X:STA $B0:CLC:ROL $B0:ROL $B1
74 ROL $B0:ROL $B1:ROL $B0:ROL $B1:CLC
76 LDA #$70 ; CHRSET
78 ADC $B1:STA $B1:TXA:PHA:LDY #$00
80 LDX XTEMP:MUCHO1 LDA ($B0),Y:STA $09C0,X:INX:INX:INX:INY
82 CPY #$08:BNE MUCHO1:PLA:TAX:INX:INC XTEMP
84 LDA XTEMP:CMP #$03:BNE PUT3CHR2:LDA #$00:STA XTEMP:JSR FLIPZ:RTS
86 GCHR LDA STEMP0:STA $B0:LDA STEMP1:STA $B1:LDX #$00
88 NEXCHR LDY #$00:LDA ($B0),Y:CMP #$00:BEQ RESET:STA CHTEMP,X:INC $B0
90 BNE NEXCHR2:INC $B1:NEXCHR2 INX:CPX #$03:BNE NEXCHR:LDA $B0:STA STEMP0
92 LDA $B1:STA STEMP1:RTS:RESET LDA #<TEXT:LDX #>TEXT:STA STEMP0:STX STEMP1:RTS
94 FLIPZ LDA $B0:PHA:LDA $B1:PHA:LDA ZTEMP:STA $B0:LDA ZTEMP+1:STA $B1
96 PLA:STA ZTEMP+1:PLA:STA ZTEMP:RTS
97 STEMP0 .BYTE $00:STEMP1 .BYTE $00:CHTEMP .BYTE $00,$00,$00:XTEMP .BYTE $00
98 ZTEMP .BYTE $00,$00
99 TEXT .TEXT "HERE IS THE SPRITE SCROLL IN PAL!                          ":BRK